{"version":3,"sources":["../../src/router/upload.js"],"names":["router","Router","post","req","res","form","IncomingForm","encoding","url","uploadDir","keepExtensions","maxFieldsSize","parse","err","fields","files","file","path","name","rePath","rename","Error","json","code","msg","imgUrl"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,SAAS,kBAAQC,MAAR,EAAf;;AAEAD,OAAOE,IAAP,CAAY,aAAZ,EAA2B,UAACC,GAAD,EAAMC,GAAN,EAAc;AACvC,MAAMC,OAAO,IAAI,qBAAWC,YAAf,EAAb;AACAD,OAAKE,QAAL,GAAgB,OAAhB;AACA,MAAMC,MAAM,gDAAZ;AACAH,OAAKI,SAAL,GAAiBD,GAAjB;AACAH,OAAKK,cAAL,GAAsB,IAAtB,CALuC,CAKV;AAC7BL,OAAKM,aAAL,GAAqB,IAAI,IAAJ,GAAW,IAAhC,CANuC,CAMD;AACtCN,OAAKO,KAAL,CAAWT,GAAX,EAAgB,UAACU,GAAD,EAAMC,MAAN,EAAcC,KAAd,EAAwB;AACtC,QAAIA,KAAJ,EAAW;AAAA,wBACUA,MAAMC,IADhB;AAAA,UACJC,IADI,eACJA,IADI;AAAA,UACEC,IADF,eACEA,IADF;;AAET,UAAIC,SAASX,MAAMU,IAAnB;AACA,mBAAGE,MAAH,CAAUH,IAAV,EAAgBE,MAAhB,EAAwB,UAACN,GAAD,EAAS;AAC/B,YAAGA,GAAH,EAAO;AACL,gBAAMQ,MAAMR,GAAN,CAAN;AACD,SAFD,MAEK;AACHT,cAAIkB,IAAJ,CAAS;AACPC,kBAAM,CADC;AAEPC,iBAAK,MAFE;AAGPC,sDAAwCP;AAHjC,WAAT;AAKD;AACF,OAVD;AAWD;AACF,GAhBD;AAiBD,CAxBD;;kBA0BelB,M","file":"upload.js","sourcesContent":["import express from 'express';\nimport formidable from 'formidable'\nimport fs from 'fs'\n\nconst router = express.Router();\n\nrouter.post('/api/upload', (req, res) => {\n  const form = new formidable.IncomingForm()\n  form.encoding = 'utf-8';\n  const url = \"/Users/moran/Desktop/project/vueServer/public/\";\n  form.uploadDir = url;\n  form.keepExtensions = true;  // 保留文件后缀\n  form.maxFieldsSize = 4 * 1024 * 1024; // 文件大小\n  form.parse(req, (err, fields, files) => {\n    if (files) {\n      let {path, name} = files.file;\n      let rePath = url + name;\n      fs.rename(path, rePath, (err) => {\n        if(err){\n          throw Error(err)\n        }else{\n          res.json({\n            code: 1,\n            msg: '上传成功',\n            imgUrl: `http://localhost:8083/public/${name}`\n          })\n        }\n      })\n    }\n  });\n});\n\nexport default router"]}