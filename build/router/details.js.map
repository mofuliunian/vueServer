{"version":3,"sources":["../../src/router/details.js"],"names":["fs","require","proxy","createProxyServer","router","Router","obj","parse","process","cwd","excelObj","data","console","log","i","arr","value","j","push","buffer","build","name","writeFileSync","on","err","req","res","writeHead","end","get","download","web","target"],"mappings":";;;;;;AAAA;;;;AACA;;AAGA;;;;AAEA;;;;;;AAHA;AAIA,IAAMA,KAAKC,QAAQ,IAAR,CAAX;AAFA;;;AAIA,IAAMC,QAAQ,oBAAUC,iBAAV,CAA4B,EAA5B,CAAd;;AAEA,IAAMC,SAAS,kBAAQC,MAAR,EAAf;;AAEA,IAAIC,MAAM,mBAAKC,KAAL,CAAWC,QAAQC,GAAR,KAAgB,mBAA3B,CAAV,C,CAA0D;AAC1D,IAAIC,WAASJ,IAAI,CAAJ,EAAOK,IAApB,C,CAAyB;AACzBC,QAAQC,GAAR,CAAYH,QAAZ;AACA,IAAIC,OAAO,EAAX;AACA,KAAI,IAAIG,CAAR,IAAaJ,QAAb,EAAsB;AAClB,QAAIK,MAAI,EAAR;AACA,QAAIC,QAAMN,SAASI,CAAT,CAAV;AACA,SAAI,IAAIG,CAAR,IAAaD,KAAb,EAAmB;AACfD,YAAIG,IAAJ,CAASF,MAAMC,CAAN,CAAT;AACH;AACDN,SAAKO,IAAL,CAAUH,GAAV;AACH;AACDH,QAAQC,GAAR,CAAYF,IAAZ,EAAkB,MAAlB;AACA,IAAIQ,SAAS,mBAAKC,KAAL,CAAW,CACpB;AACIC,UAAK,QADT;AAEIV,UAAKA;AAFT,CADoB,CAAX,CAAb;;AAOA;AACAX,GAAGsB,aAAH,CAAiB,YAAjB,EAA8BH,MAA9B,EAAqC,EAAC,QAAO,GAAR,EAArC;;AAEAjB,MAAMqB,EAAN,CAAS,OAAT,EAAkB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,GAApB,EAAyB;AACvCA,QAAIC,SAAJ,CAAc,GAAd,EAAmB;AACf,wBAAgB;AADD,KAAnB;AAGAD,QAAIE,GAAJ,CAAQ,oEAAR;AACH,CALD;;AAOAxB,OAAOyB,GAAP,CAAW,UAAX,EAAuB,UAACJ,GAAD,EAAMC,GAAN,EAAc;AACjCA,QAAII,QAAJ,CAAa,YAAb;;AAEA5B,UAAM6B,GAAN,CAAUN,GAAV,EAAeC,GAAf,EAAoB,EAAEM,QAAQ,iCAAV,EAApB;;AAEA;AACA;AACA;AACA;AACH,CATD;;kBAWe5B,M","file":"details.js","sourcesContent":["import express from 'express';\nimport { details } from \"../model/login\";\nimport {userLogin} from '../model/login'\n// 表格的操作\nimport xlsx from 'node-xlsx';\n// 反向代理\nimport httpProxy from 'http-proxy'\nconst fs = require('fs');\n\nconst proxy = httpProxy.createProxyServer({});\n\nconst router = express.Router();\n\nvar obj = xlsx.parse(process.cwd() + '/public/text.xlsx');//配置excel文件的路径\nvar excelObj=obj[0].data;//excelObj是excel文件里第一个sheet文档的数据，obj[i].data表示excel文件第i+1个sheet文档的全部内容\nconsole.log(excelObj);\nvar data = [];\nfor(var i in excelObj){\n    var arr=[];\n    var value=excelObj[i];\n    for(var j in value){\n        arr.push(value[j]);\n    }\n    data.push(arr);\n}\nconsole.log(data, 'data')\nvar buffer = xlsx.build([\n    {\n        name:'sheet1',\n        data:data\n    }        \n]);\n\n//将文件内容插入新的文件中\nfs.writeFileSync('test1.xlsx',buffer,{'flag':'w'});\n\nproxy.on('error', function (err, req, res) {\n    res.writeHead(500, {\n        'Content-Type': 'text/plain'\n    });\n    res.end('Something went wrong. And we are reporting a custom error message.');\n});\n\nrouter.get('/details', (req, res) => {\n    res.download('test1.xlsx')\n\n    proxy.web(req, res, { target: 'http://localhost:8081/api/users' }); \n\n    // const query = req.query;\n    // details(query, (data) => {\n    //     res.json(data);\n    // })\n});\n\nexport default router"]}